exec ${PAGER:-/usr/bin/less} "$0" || exit 1
Executing tests from //stubdev:cuda_onestepsap_test_vd
-----------------------------------------------------------------------------
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from KernelTest
[ RUN      ] KernelTest.OneStepSAP_GPU
Kernel Test: OneStepSap
TestOneStepSapGPU with GPU called with 1 problems
v_guess: 
 7.000000 4.000000
gamma: 
 0.000000 0.000000 -10.000000
G: 
 0.000000 0.000000 0.000000
 0.000000 0.000000 0.000000
 0.000000 0.000000 10.000000
J: 
 0.000000 0.000000
 0.000000 0.000000
 1.000000 0.000000
Momentum Cost: 1.000000
Regularization Cost: 5.000000
Hessian: 
 11.000000 0.000000
 0.000000 1.000000
A:
 1.000000 0.000000
 0.000000 1.000000
inside sum: -8.3636363636363633 
do newton
d_guess: 0.0000000000000018 
d2_guess: 8.3636363636363633 
bracket [l: 0.0000000000000000 guess: 1.0000000000000004 r: 1.5000000000000000] 
f(bracket): [f(l): -8.3636363636363633 f(guess): 0.0000000000000018 f(r): 2.3223140495867769] 

TERMINATE - root within tolerance 
do newton
d_guess: 0.0000000000000013 
d2_guess: 8.3636363636363633 
bracket [l: 0.0000000000000000 guess: 1.0000000000000002 r: 1.0000000000000004] 
f(bracket): [f(l): -8.3636363636363633 f(guess): 0.0000000000000013 f(r): 0.0000000000000018] 

neg_grad: -9.0000000000000000
neg_grad: -1.0000000000000000
momentum_residue: 9.0553851381
momentum_scale: 6.8713081748
v_guess: 
6.1818181818181817
3.0000000000000000
v_star: 
8.0000000000000000
3.0000000000000000
chol_x: 
-0.8181818181818182
-1.0000000000000000
tot ell: 
1.8181818181818181
this is a step of cholsolve
alpha at this step is 1.0000000000


v_guess: 
 6.181818 3.000000
gamma: 
 0.000000 0.000000 -1.818182
G: 
 0.000000 0.000000 0.000000
 0.000000 0.000000 0.000000
 0.000000 0.000000 10.000000
J: 
 0.000000 0.000000
 0.000000 0.000000
 1.000000 0.000000
Momentum Cost: 1.652893
Regularization Cost: 0.165289
Hessian: 
 11.000000 0.000000
 0.000000 1.000000
A:
 1.000000 0.000000
 0.000000 1.000000
inside sum: -0.0000000000000000 
TERMINATE - early accept, no root in bracket 
TERMINATE - early accept, der too small 
neg_grad: 0.0000000000000018
neg_grad: -0.0000000000000000
momentum_residue: 0.0000000000
momentum_scale: 6.8713081748
OUTER TERMINATE - momentum residue
OUTER TERMINATE - cost criteria
v_guess: 
6.1818181818181817
3.0000000000000000
v_star: 
8.0000000000000000
3.0000000000000000
chol_x: 
0.0000000000000002
-0.0000000000000000
tot ell: 
1.8181818181818181
this is a step of cholsolve
alpha at this step is 1.0000000000


SAP Converged!
stubdev/cuda_onestepsap_test_vd.cc:63: Failure
Expected: (abs((v_solved_cpu - v_solved[i]).norm())) < (1e-1), actual: 0.18181818181818166 vs 0.1

[  FAILED  ] KernelTest.OneStepSAP_GPU (207 ms)
[----------] 1 test from KernelTest (207 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (207 ms total)
[  PASSED  ] 0 tests.
[  FAILED  ] 1 test, listed below:
[  FAILED  ] KernelTest.OneStepSAP_GPU

 1 FAILED TEST
